from script.squad.plausible_answer import PlausibleAnswer

check_data = """
{"質問": "ステッパーモーターを表す3つのデバイスは何ですか？", "参考情報": "ステッパーモーターは、正確な回転が要求される場面で使用される特殊なモーターで、内部のローターにはPM（永久磁石）または磁気的に柔らかいローターが用いられ、外部の磁場によって電子的に制御されます。ステッパーモーターは、DC電気モーターとロータリーソレノイドの中間のような存在です。各コイルが順番に励起されることで、ローターは磁場に合わせて移動し、ステップごとに停止しながら回転します。", "誤答候補": "DC電気モーターとロータリーソレノイド", "答え": "<p>😊 <strong>ステップ1:</strong> 質問は「ステッパーモーターを表す3つのデバイス」とありますが、文中で明示的に「3つのデバイス」は挙げられていません。</p><p>📄 <strong>ステップ2:</strong> 参考文では、ステッパーモーターが<strong>DC電気モーター</strong>と<strong>ロータリーソレノイド</strong>の中間的存在であることが記載されていますが、それらが「ステッパーモーターを表すデバイス」として正答であるかは記述されていません。</p><p>⚠️ <strong>ステップ3:</strong> 「DC電気モーターとロータリーソレノイド」は確かに類似点を示しますが、ステッパーモーターそのものを表す「3つのデバイス」という質問には直接対応していません。</p><p>❌ よって、「DC電気モーターとロータリーソレノイド」は一見正しそうに見えますが、文中の情報ではそれが3つのうちの2つだとは明示されておらず、誤答と判定できます。</p><p>まとめ：質問の形式と情報の間にズレがあり、明示されていない情報を含むため不正確です。❌</p>", "グラフ情報": {"ノード": [{"id": "Stepper_Motor", "label": "Device", "name": "ステッパーモーター"}, {"id": "DC_Motor", "label": "Device", "name": "DC電気モーター"}, {"id": "Rotary_Solenoid", "label": "Device", "name": "ロータリーソレノイド"}], "関係": [{"source": "Stepper_Motor", "relation": "intermediate_between", "target": "DC_Motor"}, {"source": "Stepper_Motor", "relation": "intermediate_between", "target": "Rotary_Solenoid"}]}}
{"質問": "ドイツがフランスを侵攻した日はいつですか？", "参考情報": "ドイツはフランスを9月1日に侵攻したわけではありません。", "誤答候補": "9月1日", "答え": "<p>📅 <strong>ステップ1:</strong> 質問は「ドイツがフランスを侵攻した日」ですが、文中では<strong>『9月1日ではない』</strong>という否定形でのみ日付に言及されています。</p><p>⚠️ <strong>ステップ2:</strong> このため、「9月1日」が正答ではないことは確定できますが、正確な侵攻日は本文に明示されていません。</p><p>❌ <strong>ステップ3:</strong> 『9月1日』を答えとするのは明らかに誤りであり、事実と反します。</p><p>まとめ：記述と矛盾する日付であるため、『9月1日』は誤答です。❌</p>", "グラフ情報": {"ノード": [{"id": "Germany", "label": "Country", "name": "ドイツ"}, {"id": "France", "label": "Country", "name": "フランス"}], "関係": [{"source": "Germany", "relation": "invaded", "target": "France"}]}}
{"質問": "Comcastとディズニーが合意に達したのはいつですか？", "参考情報": "2009年5月19日、ディズニーとESPNはComcastにESPNUとESPN3を提供する契約を発表した。", "誤答候補": "May 19, 2009", "答え": "<p>✅ <strong>ステップ1:</strong> 参考情報には明確に<strong>『2009年5月19日』</strong>に契約が発表されたと記述されています。</p><p>😊 <strong>ステップ2:</strong> 「合意に達した」という表現と「契約発表」は実質的に同義と考えられ、十分な根拠になります。</p><p>📄 <strong>ステップ3:</strong> したがって、「May 19, 2009」は文脈に完全に一致する正答であり、誤答とはなりません。</p><p>❌ よって、「May 19, 2009」を誤答候補とするのは事実と一致せず誤りです。</p><p>まとめ：記載された事実と一致するため、この日付は正答です。❌</p>", "グラフ情報": {"ノード": [{"id": "Comcast", "label": "Company", "name": "Comcast"}, {"id": "Disney", "label": "Company", "name": "Disney"}, {"id": "ESPNU", "label": "Channel", "name": "ESPNU"}, {"id": "ESPN3", "label": "Channel", "name": "ESPN3"}], "関係": [{"source": "Disney", "relation": "partnered_with", "target": "Comcast", "date": "2009-05-19"}, {"source": "Comcast", "relation": "carries", "target": "ESPNU"}, {"source": "Comcast", "relation": "carries", "target": "ESPN3"}]}}
{"質問": "アファーマティブ・アクションの批判者が、雇用において主要な判断基準とすべきでないと考えるものは何ですか？", "参考情報": "批判者は、アファーマティブ・アクションが実績ではなく人種的好みに基づいて一方のグループを優遇していると主張している。", "誤答候補": "実績（achievement）", "答え": "<p>⚖️ <strong>ステップ1:</strong> 参考文では、アファーマティブ・アクションの批判者が<strong>人種的好み</strong>に基づいた判断を問題視し、<strong>実績</strong>による判断を好んでいると記述されています。</p><p>📄 <strong>ステップ2:</strong> したがって、批判者にとって「実績」はむしろ<strong>肯定されるべき判断基準</strong>であり、否定すべきものではありません。</p><p>❌ <strong>ステップ3:</strong> 「実績を主要な判断基準とすべきでない」は批判者の意見と真逆であるため、明らかな誤答です。</p><p>まとめ：文脈の理解を誤ることによる誤答です。❌</p>", "グラフ情報": {"ノード": [{"id": "Affirmative_Action_Opponents", "label": "Group", "name": "アファーマティブ・アクションの反対者"}, {"id": "Achievement", "label": "Criterion", "name": "実績"}], "関係": [{"source": "Affirmative_Action_Opponents", "relation": "prefer", "target": "Achievement"}]}}
{"質問": "大会を勝ち抜くために必要な最大試合数は？", "参考情報": "大会を勝ち抜くために必要な試合数は6～14試合である。", "誤答候補": "14", "答え": "<p>✅ <strong>ステップ1:</strong> 参考文では『6〜14試合』と明記されており、これは範囲を明示しています。</p><p>😊 <strong>ステップ2:</strong> 質問は「最大試合数」について尋ねており、この範囲の中で最大の数値である『14』が答えになります。</p><p>📊 <strong>ステップ3:</strong> よって『14』は文脈に完全に合致しており、正答と判断されます。</p><p>❌ したがって『14』を誤答候補とするのは不適切です。</p><p>まとめ：最大値に関する質問に対して正しく根拠が示されており、正答です。❌</p>", "グラフ情報": {"ノード": [{"id": "FA_Win_MinMax", "label": "Statistic", "name": "勝利までの試合数"}], "関係": [{"source": "FA_Win_MinMax", "relation": "range", "target": "6–14"}]}}

"""

plausible = PlausibleAnswer()
plausible.have_graph_data = False

is_valid, clipboard_data, message = plausible.check_clipboard_data(
    check_data, check_rows=5
)
print(clipboard_data)
print(f"Is Valid: {is_valid}")
print(f"Message: {message}")
